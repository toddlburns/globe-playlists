const fs = require('fs');

// Decade lookup from add-decades.js
const decades = {
  "Afrobeat, Chill": "1970s",
  "Afrobeat, Groovers": "1970s",
  "Afrobeat, Heavy": "1970s",
  "Afrobeats, Groovers": "2010s",
  "Alex Kasau Katombi": "1980s",
  "Amapiano": "2010s",
  "Amapiano, Gospel": "2010s",
  "Amapiano, Private School": "2010s",
  "Amapiano, Starter Pack": "2010s",
  "Asakaa": "2020s",
  "Asakaa, Starter Pack": "2020s",
  "Azonto / Hiplife": "2010s",
  "Benga & Kamba Pop, Modern": "2000s",
  "Benga & Kamba Pop, Vintage": "1970s",
  "Biama": "2010s",
  "Bikutsi": "1980s",
  "Bikutsi, Contemporary": "2000s",
  "Cabo Verde, Vintage R&B": "1970s",
  "Cabo Verde, Vintage Rock And Funk": "1970s",
  "Chimurenga": "1970s",
  "Coupé-décalé": "2000s",
  "Ethiopia, Blues": "1960s",
  "Ethiopia, Funk & Soul": "1970s",
  "Ethiopia, Jazz": "1960s",
  "Ethiopia, Jazz Vocal": "1960s",
  "Funaná": "1980s",
  "Gqom, Club": "2010s",
  "Gqom, Pop": "2010s",
  "Gqom, Sghubu": "2010s",
  "Gqom, Sghubu Pop": "2010s",
  "Gqom, Starter Pack": "2010s",
  "Hees Macaan": "1970s",
  "Hees Macaan, Starter Pack": "1970s",
  "Highlife, Vintage Jazzy": "1960s",
  "Highlife, Vintage Peppy": "1960s",
  "Kizomba": "1980s",
  "Kora": "1970s",
  "Kuduro, Contemporary": "2010s",
  "Kuduro, Contemporary Riddims": "2010s",
  "Kuduro, Vintage": "2000s",
  "Kuduro, Vintage Riddims": "2000s",
  "Kwaito, Old School MCs": "1990s",
  "Kwaito, Swinging Beats": "1990s",
  "Kwaito, Vintage Classic": "1990s",
  "Kwaku DMC": "2020s",
  "Mahraganat": "2010s",
  "Mahraganat, Starter Pack": "2010s",
  "Makossa": "1970s",
  "Mbalax": "1980s",
  "Mbalax, Contemporary Pop": "2010s",
  "Mbalax, Contemporary Rap": "2010s",
  "Mbalax, Mark Ernestus": "2010s",
  "Mbaqanga": "1960s",
  "Mbira": "1970s",
  "Príncipe, Chill": "2010s",
  "Rumba, Vintage": "1960s",
  "Salegy & Kawitry": "1990s",
  "Salegy & Kawitry, Starter Pack": "1990s",
  "Sega": "1970s",
  "Sega, Psych": "1970s",
  "Singeli": "2010s",
  "Soukous, Chill": "1980s",
  "Soukous, Dance": "1980s",
  "South Africa, 80s Electronic": "1980s",
  "Tigrinya": "2000s",
  "Tigrinya, Vintage": "1970s",
  "Tsapiky": "2000s",
  "Tuareg": "2000s",
  "Wawa Salegy": "2000s",
  "Xitsonga / Shangaan Electro / Tsonga ": "2010s",
  "Xitsonga / Shangaan Electro / Tsonga  Starter Pack": "2010s",
  "Xitsonga / Tsonga, Downtempo": "2000s",
  "Zouglou": "1990s",
  "Zouglou, Rapide": "1990s",
  "Zouk, Fast": "1980s",
  "Zouk, Slow": "1980s",
  "Zouk, Smooth": "1980s",
  "Zouk, Starter Pack": "1980s",
  "Dr. Thomas Chauke": "1990s",
  "Igbo, Trips": "1970s",
  "Africa, Smooth Bangers": "2010s",
  "Africa, Acoustic Bangers": "2010s",
  "Africa, Hype Bangers": "2010s",
  "Africa, Vintage": "1970s",
  "Calypso, Classic": "1950s",
  "Dancehall / Ragga, Classic": "1990s",
  "Dub": "1970s",
  "Jamaica, Laidback Reggae": "1970s",
  "Jamaica, Lovers Rock": "1980s",
  "Jamaica, Vintage Pop": "1960s",
  "Ska, 1st Wave": "1960s",
  "Ska, 2nd Wave": "1980s",
  "Ska, Punk": "1990s",
  "Ska, Revival": "1990s",
  "Sad Sierreño": "2010s",
  "Latin, Classic": "1960s",
  "Latin, Melancholic Electronic": "2010s",
  "Brazil, Bumping": "2000s",
  "Brazil, Chill": "1970s",
  "Brazil, Funk & Soul": "1970s",
  "Brazil, Psychedelic": "1970s",
  "Brazil, Vibes": "1970s",
  "City Pop, Funky": "1980s",
  "City Pop, Smooth": "1980s",
  "Envy": "2000s",
  "Fumio Miyashita": "1980s",
  "Fumio Miyashita, Ambient": "1980s",
  "Fumio Miyashita, Oddballs": "1980s",
  "Ambient, Japan": "1980s",
  "Atom TM": "2000s",
  "Atom TM, Ambient": "2000s",
  "Atom TM, Chill": "2000s",
  "Atom TM, Digital Hardcore": "1990s",
  "Atom TM, Electronic Experimental": "2000s",
  "Atom TM, Electronic Heavy": "2000s",
  "Atom TM, Electronic Soft": "2000s",
  "Atom TM,  Electronic Soft": "2000s",
  "Atom TM, Glitch": "2000s",
  "Atom TM, Latin Experimental": "2000s",
  "Atom TM, Latin Pop": "2000s",
  "Atom TM, Pop Dark": "2000s",
  "Atom TM, Pop Light": "2000s",
  "Atom TM, Starter Pack": "2000s",
  "Burnt Friedman": "2000s",
  "Conrad Schnitzler, Starter Pack": "1970s",
  "Flanger": "2000s",
  "Joel Vandroogenbroeck": "1970s",
  "Kosmische, Experimental": "1970s",
  "Kosmische, Hard": "1970s",
  "Kosmische, Soft": "1970s",
  "Krautrock, Jams": "1970s",
  "Motorik, Driving": "1970s",
  "Motorik, Experimental": "1970s",
  "Motorik, Heavy": "1970s",
  "Motorik, Kosmische": "1970s",
  "Motorik, Pop": "1970s",
  "Pete Namlook, Beatless": "1990s",
  "Pete Namlook, Beats": "1990s",
  "Pete Namlook, Starter Pack": "1990s",
  "Popol Vuh": "1970s",
  "Roedelius": "1970s",
  "Schaffel Brutal": "2000s",
  "Schaffel Dance": "2000s",
  "Schaffel Pop": "2000s",
  "STL": "2010s",
  "Tangerine Dream": "1970s",
  "Tangerine Dream, Starter Pack": "1970s",
  "Synth, Cinematic Soundtracks": "1970s",
  "Synth, Ecstatic Minimalist Experiments": "1970s",
  "Synth, Foggy German Forest": "1970s",
  "Synth, Modular Experiments": "1970s",
  "Synth, Modular Heartstrings": "1970s",
  "Synth, Mysterious And Meandering": "1970s",
  "ASC, Ambient": "2000s",
  "ASC, Drum & Bass Dark": "2000s",
  "ASC, Drum & Bass Light": "2000s",
  "ASC, Electronica Dark": "2000s",
  "ASC, Electronica Light": "2000s",
  "ASC, Starter Pack": "2000s",
  "ASC, Techno": "2000s",
  "Autechre, Odds & Sods": "1990s",
  "Autechre, Post 2000": "2000s",
  "Autechre, Pre 2000": "1990s",
  "Aleksi Perälä, Ambient": "2000s",
  "Aleksi Perälä, Ambient Beats": "2000s",
  "Aleksi Perälä, Beats": "2000s",
  "Drum & Bass, Dark": "1990s",
  "Drum & Bass, Light": "1990s",
  "Drum & Bass, Liquid": "2000s",
  "Durutti Column": "1980s",
  "Dylan Henner": "2010s",
  "Fennesz ": "2000s",
  "Fennesz, Starter Pack": "2000s",
  "IDM, Sweet Melodic": "1990s",
  "Piano Magic": "2000s",
  "Piano Magic, Starter Pack": "2000s",
  "Plaid": "1990s",
  "Post-Rock, Abstract & Experimental": "1990s",
  "Post-Rock, Chiming Guitars": "1990s",
  "Post-Rock, Crescendo-Core": "2000s",
  "Post-Rock, Floating": "2000s",
  "Post-Rock, Hushed": "2000s",
  "Post-Rock, Menacing": "2000s",
  "Stereolab": "1990s",
  "Stereolab, Chill": "1990s",
  "Stereolab, Rocking": "1990s",
  "Stereolab, Starter Pack": "1990s",
  "Stereolab, Trance": "1990s",
  "Dub Techno For The Isolation Tank": "2000s",
  "House, Ambient": "1990s",
  "House, Classic": "1980s",
  "House, Deep": "1990s",
  "House, Dusty": "1990s",
  "House, Melodic": "2000s",
  "Italo, Classic": "1980s",
  "Juan Atkins": "1980s",
  "Techno, Ambient": "1990s",
  "Techno, Banging": "1990s",
  "Techno, Classic": "1980s",
  "Techno, Underwater": "1990s",
  "Techno, Warehouse": "1990s",
  "Trance, Ambient": "1990s",
  "Trance, Experimental": "1990s",
  "Hip-Hop, 1985-1992": "1980s",
  "Hip-Hop, 90s / 00s Lyricists": "1990s",
  "Hip-Hop, Dusty": "1990s",
  "Hip-Hop, Hard Beats": "1990s",
  "Hip-Hop, Instrumentals": "2000s",
  "Hip-Hop, Melancholy": "1990s",
  "Hip-Hop, Neo-Soul": "2000s",
  "R&B, 80s Dance": "1980s",
  "R&B, 80s Smooth": "1980s",
  "R&B, 90s": "1990s",
  "R&B, 90s Smooth": "1990s",
  "R&B, Early 90s Dance": "1990s",
  "R&B, Late 90s Dance": "1990s",
  "R&B, 00s Smooth": "2000s",
  "R&B, 00s Dance": "2000s",
  "R&B, 2020s Dance": "2020s",
  "R&B, Baby Makers": "1990s",
  "R&B, Contemporary Melancholy": "2010s",
  "R&B, Disco/Funk": "1970s",
  "R&B, Insecure": "2010s",
  "R&B, Neo-Soul": "2000s",
  "R&B, New Jack Swing": "1990s",
  "R&B, Vintage Dreamy": "1960s",
  "Acetone": "1990s",
  "Arab Strap": "1990s",
  "Beach Boys, Experimental": "1960s",
  "Chamber Pop, 60s": "1960s",
  "Country, Classic": "1970s",
  "Country, Heartbreakers": "1970s",
  "Elvis, Rockin\u2019": "1950s",
  "Elvis, Melancholy": "1960s",
  "Ennio Morricone": "1960s",
  "Frank Zappa, Chill": "1970s",
  "Frank Zappa, Doo Wop": "1960s",
  "Frank Zappa, Guitar": "1970s",
  "Frank Zappa, Psychedelic Pop": "1960s",
  "Grouper": "2010s",
  "Ida": "1990s",
  "Low": "1990s",
  "Low, Experimental": "2000s",
  "Low, Heartbreakers": "1990s",
  "Low, Starter Pack": "1990s",
  "Pedro The Lion": "2000s",
  "Piero Umiliani": "1960s",
  "Post-Hardcore": "1990s",
  "Rock, 60s Beat": "1960s",
  "Rock, Classic Rock Radio": "1970s",
  "Rock, Early": "1950s",
  "Rock, Soft": "1970s",
  "Rock, Smooth": "1970s",
  "Sadcore": "1990s",
  "Sigur Ros": "2000s",
  "Slowcore": "1990s",
  "Synth, Pop 80s": "1980s",
  "Synth, Pop Dystopia": "1980s",
  "Synth, Pop Melancholy": "1980s",
  "Synth, Pop Oddballs": "1980s",
  "Alessandro Cortini": "2010s",
  "Kaitlyn Aurelia Smith": "2010s",
  "Ambient, Ancient": "1970s",
  "Ambient, Balearic": "1990s",
  "Ambient, Classical Swells": "2000s",
  "Ambient, Country": "2010s",
  "Ambient, Faded": "2000s",
  "Ambient, Floating": "2000s",
  "Ambient, Heartstrings": "2000s",
  "Ambient, Kompakt Queasy": "2000s",
  "Ambient, Outer Space": "1990s",
  "Ambient, Techno": "1990s",
  "Ambient, Water": "2000s",
  "Electronic, Abandoned Cities": "2000s",
  "Electronic, Downtempo": "2000s",
  "Electronic, Experimental Chill": "2000s",
  "Electronic, Goth Experiments": "1980s",
  "Electronic, Imaginary Jungles": "2000s",
  "Electronic, Industrial Digital Noise Pop": "1990s",
  "Electronic, Melancholic Breakbeats": "2000s",
  "Electronic, Skittering Beats And Moody Synths": "2000s",
  "Electronic, Unpredictable Rhythms": "2000s",
  "Electronic, Wonky House And Techno": "2010s",
  "Electronica, Light": "2000s",
  "Balearic Music": "1990s",
  "Balearic, Pop": "1990s",
  "Blues, Chill": "1960s",
  "Blues, Early": "1930s",
  "Boogie": "1980s",
  "Dinner Party Funk": "1970s",
  "Easy Listening": "1960s",
  "Enya": "1990s",
  "Experimental, Ancient": "1970s",
  "Experimental, Celestial Digital Pop": "2010s",
  "Experimental, Durational Dissonance": "2000s",
  "Experimental, Dying Cities": "2000s",
  "Experimental, Guitar Glitch Ambient": "2000s",
  "Experimental, Guitar Haze": "2000s",
  "Flamenco": "1970s",
  "Flamenco, Bulerías": "1970s",
  "Flamenco, Guitar": "1970s",
  "France, Vintage Pop": "1960s",
  "France, Vintage Mellow": "1960s",
  "Arthur Lyman, Chill": "1960s",
  "Jazz, Cool": "1950s",
  "Jazz, Funk": "1970s",
  "Lounge, Chill": "1960s",
  "Lounge, Kicking": "1960s",
  "Minimal, Dark, And Cold Wave": "1980s",
  "Minimalism": "1970s",
  "New Age": "1980s",
  "Pacific Island, Chill": "1970s",
  "Pop, Widescreen": "1990s",
  "Solo Guitar": "1970s",
  "Turkey, Psych Funk": "1970s",
  "Funk, Worldwide": "1970s",
  "Autumn": "2000s",
  "By The Way, Vol. 1": "2000s",
  "By The Way, Vol. 10": "2000s",
  "By The Way, Vol. 2": "2000s",
  "By The Way, Vol. 3": "2000s",
  "By The Way, Vol. 4": "2000s",
  "By The Way, Vol. 5": "2000s",
  "By The Way, Vol. 6": "2000s",
  "By The Way, Vol. 7": "2000s",
  "By The Way, Vol. 8": "2000s",
  "By The Way, Vol. 9": "2000s",
  "Chill Worldwide": "2000s",
  "Haunted Ballroom, Happy": "1940s",
  "Haunted Ballroom, Sad": "1940s",
  "Sad Songs": "1990s",
  "Sad Songs, Vintage": "1960s",
  "Summer Patio Songs": "2000s",
  "Sunday Morning Songs": "2000s",
  "Vintage, Dreamy Melancholy": "1960s",
  "Vocal Groups, Sad": "1950s",
  "Yet They Say, Vol. 1": "2000s",
  "Yet They Say, Vol. 10": "2000s",
  "Yet They Say, Vol. 2": "2000s",
  "Yet They Say, Vol. 3": "2000s",
  "Yet They Say, Vol. 4": "2000s",
  "Yet They Say, Vol. 5": "2000s",
  "Yet They Say, Vol. 6": "2000s",
  "Yet They Say, Vol. 7": "2000s",
  "Yet They Say, Vol. 8": "2000s",
  "Yet They Say, Vol. 9": "2000s",
  "Worldwide, Chiming Guitar": "2000s",
  "Worldwide, Smooth Mid-Tempo R&B": "2000s",
  "Worldwide, Chanting And Drumming": "1970s",
  // Fixes for mismatched names
  "Elvis, Rockin\u2019": "1950s",
  "Elvis, Rockin'": "1950s",
  "Worldwide, Funk": "1970s",
  "Gqom, Sgubhu": "2010s",
  "Gqom, Sgubhu Pop": "2010s",
  "Kwaito, Vintage Chill": "1990s",
  "Post-Rock , Abstract & Experimental": "1990s",
};

// Read the existing playlists-data.js
const content = fs.readFileSync('playlists-data.js', 'utf8');

// Extract the array using a regex approach - find the JSON array
const arrayStart = content.indexOf('[');
const arrayEnd = content.lastIndexOf(']') + 1;
const prefix = content.substring(0, arrayStart);
const arrayStr = content.substring(arrayStart, arrayEnd);
const suffix = content.substring(arrayEnd);

// Parse it
const playlists = JSON.parse(arrayStr);

let matched = 0;
let unmatched = [];

// Add decade to each playlist
playlists.forEach(p => {
  // Try exact match first
  let decade = decades[p.name];

  // Try trimmed match
  if (!decade) {
    decade = decades[p.name.trim()];
  }

  // Try matching with trailing space variants
  if (!decade) {
    for (const key of Object.keys(decades)) {
      if (key.trim() === p.name.trim()) {
        decade = decades[key];
        break;
      }
    }
  }

  if (decade) {
    p.decade = decade;
    matched++;
  } else {
    p.decade = "unknown";
    unmatched.push(p.name);
  }
});

// Write out
const output = prefix + JSON.stringify(playlists, null, 2) + suffix;
fs.writeFileSync('playlists-data.js', output);

console.log(`Total playlists: ${playlists.length}`);
console.log(`Matched: ${matched}`);
console.log(`Unmatched: ${unmatched.length}`);
if (unmatched.length > 0) {
  console.log('Unmatched names:');
  unmatched.forEach(n => console.log(`  "${n}"`));
}
